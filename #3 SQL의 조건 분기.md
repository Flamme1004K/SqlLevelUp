# #3 SQL의 조건 분기

## 나의 결론
- UNION 조건 분기에 대해서 좀 더 생각해보고 사용을 해보자.
- WHERE 구에서 조건 분기보다 SELECT 구만으로 조건 분기를 하면 더욱 최적화 할 수 있다.
- SQL을 절차지향적이게가 아닌 선언형으로 짜라.

## UNION의 사용

- UNION 조건 분기를 사용하기 이전에 CASE 조건 분기를 생각하라.
- UNION이 필요한 경우일 때 UNION을 사용하라.

### UNION 조건 분기를 사용하기 이전에 CASE 조건 분기를 사용하라.

#### UNION 사용의 단점.
- SQL의 길이가 길어서 읽기 힘들다.
	- 쓸데 없는 테이블 접근을 발생시킬 수 있다.
- I/O 비용이 크게 늘어난다.
	-  UNION의 사용은 외부적으로는 하나의 SQL을 실행하는 것처럼 보이지만, 내부적으로는 여러개의 SELECT를 실행하는 실행 계획으로 해석 된다.
	- 테이블에 대해서 FULL SACN을 한다.

### UNION 사용 단점의 해결
- UNION 조건 분기를 사용하기 이전에 CASE 조건 분기를 사용하라.
	- 단, CASE문도, WHERE 구에서 조건 분기보다 SELECT 구만으로 조건 분기를 하면 더욱 최적화 할 수 있기 때문에, WHERE 구에서 쓰는 것보다는 SELECT 구에서 사용하라.

### UNION이 필요한 경우
- merge 대상이 되는 SELECT 구문들에서 사용하는 테이블이 다른 경우
- UNION이 성능적으로 더 좋은 경우

UNION을 CASE보다 성능적으로 좋게 하기 위해서는, UNION의 WHERE 구분에 해당 되는 컬럼에 대해서 INDEX를 설정을 하면, CASE문에 대해 한번 FULL SACN하는 것보다 좋은 이점을 가질 수 있다.


## SQL 절차지향적이 아닌 선언형으로 짜라.

## 책의 결론
- SQL의 성능은 저장소의 I/O를 얼마나 감소시킬지 있을지가 열쇠
- UNION에서 조건 분기를 표현하다면 "내가 지금 쓸데없이 길게 쓰고 있는 것은 아닐까?" 라는 것을 항상 의식할 것
- IN 또는 CASE 식으로 조건 분기를 표현할 수 있다면, 테이블에의 스캔을 크게 감소스킬 가능성이 있음.
- 이를 위해서라도, 구문에서 식으로의 패러다음 전환을 연습.

